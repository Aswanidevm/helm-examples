steps:
  - name: 'gcr.io/cloud-builders/gcloud'  # Use the official gcloud builder image
    id: Pre-build steps
    entrypoint: /bin/bash
    args: 
      - -c
      - |
        gcloud compute os-login describe-profile
        for i in $(gcloud compute os-login ssh-keys list); do echo $i; gcloud compute os-login ssh-keys remove --key $i; done
        echo "All previous Keys deleted from Cloudbuild's profile"
        
        echo " Creating build-id folder with $COMMIT_SHA and build-id=$BUILD_ID and revison_id=$REVISION_ID"
        gcloud compute ssh ftwomicroinstance --zone=asia-south1-a --project jmc-devsecops --command 'mkdir $COMMIT_SHA && ls'  --tunnel-through-iap --force-key-file-overwrite --strict-host-key-checking=no
  # - name: 'gcr.io/cloud-builders/gcloud'  # Use the official gcloud builder image
  #   entrypoint: /bin/bash
  #   args: 
  #     - -c
  #     - |
  #       gcloud compute scp --recurse /workspace ftwomicroinstance:~/deploymentscripts/ --zone=asia-south1-a --tunnel-through-iap --force-key-file-overwrite --strict-host-key-checking=no
  #       gcloud compute ssh ftwomicroinstance --zone=asia-south1-a --project jmc-devsecops --command 'pwd && cd deploymentscripts/workspace/ && ls'  --tunnel-through-iap --force-key-file-overwrite --strict-host-key-checking=no
      




